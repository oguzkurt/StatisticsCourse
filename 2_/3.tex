\documentclass{ximera}
\input{../preamble.tex}
\title{Counting and Probability II-- Homework 3}
\author{Oguz Kurt}

\begin{document}
\begin{abstract}
In this HW, you are expected to solve basic probability problems. To succeed, you are expected to know basics of counting, probability and, (relative) frequency. While we have not defined it, we will later use the knowledge of frequencies in learning probability distribution function (pdf) and cumulative distribution function (cdf).
\end{abstract}
\maketitle

\begin{sagesilent}
def c(n,k):
    if 0<=k and k <=n:
        return binomial(n,k)
    else:
        return "error"

def p(n,k):
    if 0<=k and k <=n:
        return binomial(n,k)*factorial(k)
    else:
        return "error"
def m(n,mylist):
    l=len(mylist)
    return factorial(n)/(prod([factorial(mylist[i]) for i in range(l)]))
\end{sagesilent}

\section*{Syntax}
In this HW, you are expected to solve problems of basic probability. Here is a reminder of the way to input some numbers. Please, use the parsing power of your browser instead of using a calculator.

\hspace{0.5cm}


\begin{tabular}{c|c}
Operation & Syntax  
\\
\hline
$a+b$ & {\color{red} \verb!a+b!} 
\\
\hline
$a- b$ & {\color{red} \verb!a-b!} 
\\
\hline
$a\cdot b$ & {\color{red} \verb!a*b! } 
\\
\hline
$a/b=\frac{a}{b}$ & {\color{red} \verb!a/b!}
\\
\hline
$a^b$ & {\color{red} \verb|a**b| or \verb|a^b|} 
\\
\hline
$\sqrt{a}$ & {\color{red} \verb|sqrt(a)| or \verb|a**(1/2)|} 
\\
\hline
$a!$ & {\color{red} \verb|a!|} 
\\
\hline
$\binom{a}{b}$ & {\color{red} \verb|a!/(b!*(a-b)!)|}
\\
\hline
$P_k^n$ & {\color{red} \verb|a!/(a-b)!|}
\\
\end{tabular}

\hspace{1cm}

\begin{problem}
The probability that a particular type of rifle will fire is $p$. We test the rifle $k$ times.
What is the probability it will fire in every one of $k$ independent trials? 

\begin{explanation}
\begin{sagesilent}
p=var('p')
k=var('k')
\end{sagesilent}
\begin{equation*} 
\Pr(k \text{ successes} ) = \answer[given]{\sage{p^k}}
\end{equation*}

\end{explanation}
\end{problem}


\begin{problem}
The probability that a particular type of rifle will fire is $p$. We test the rifle $k$ times.
What is the probability it will fire exactly $5$ times in $k$ independent trials? 

\begin{explanation}
\begin{sagesilent}
q=var('q')
l=var('l')
\end{sagesilent}
\begin{equation*} 
\Pr(5 \text{ successes in  } \ell \text{ trials } ) = \answer[given]{\sage{binomial(l,5)*q^5*(1-q)^(l-5)}} 
\end{equation*}
\end{explanation}
\end{problem}



\begin{problem}
A die is loaded in such a way that the probability of the face with $j$ dots turning up is proportional to $j$ for $j = 1,2, \ldots,6$. What is the probability, in one roll of the die, that an even number of dots will turn up? 
\begin{hint}
\begin{sagesilent}
j=var('j')
\end{sagesilent}
We let the probability of the face with 1 dot turning up is $p$,
then we get $p+2p+\cdots+6p=1$ and $p=\answer{\sage{1/21}}$.
Thus, probability that the side with j-dots turns up is $p_j =\answer{\sage{1/21*j}}$.
You can complete the problem by using Addition Rule.
\end{hint}

\begin{prompt}
\begin{equation*}
\Pr(X=2, 4, \text{or } 6 ) =%d\frac{2}{21}+\frac{4}{21}+\frac{6}{21} = 
\answer{\frac{4}{7}}
\end{equation*}

\end{prompt}
\end{problem}


\begin{problem}

Identical twins come from the same egg and hence are of the same sex. Fraternal twins have a 50-50 chance of being the same sex. Among twins the probability of a fraternal set is p and an identical set is $q = 1 - p$. If the next set of twins are of the same sex, what is the probability they are identical? Please, give your answer in the variable $q$ only.
\begin{sagesilent}
p=var('p')
q=var('q')
\end{sagesilent}
\begin{hint}
Let's use ``Twins'' as a categorical variable that may either be ``Identical'' or ``Fraternal''. Here is the information given in the first three columns:

\begin{tabular}{c|c|c|c}
Twins &	$\Pr$(Twins) &	$\Pr$(same sex $|$ Twins)&	$\Pr$(Twins)$\Pr$[same sex $|$ Twins] \\
\hline
Identical &	$q$ &	$\answer{1}$ &	$\answer{q}$ \\
\hline
Fraternal &	$p$	& $\answer{\frac{1}{2}}$ &	$\answer{\frac{p}{2}}$ 
\end{tabular}

We want to use Bayes Theorem. 

\end{hint}

\begin{prompt}
\begin{eqnarray*} 
\Pr(\text{Identical } | \text{same sex}) &=& \frac{\Pr(\text{same sex}|\text{Identical} )\cdot \Pr(\text{Identical})} {\Pr(\text{same sex}|\text{Identical})\cdot \Pr(\text{Identical})+\Pr(\text{same sex}|\text{Fraternal})\cdot\Pr(\text{Fraternal})} \\ 
&=&%\frac{q}{q+\frac{p}{2}} = \frac{2q}{2q+p} =
\answer{\frac{2q}{1+q}}\\ 
\end{eqnarray*}
\end{prompt}
\end{problem}


\begin{problem}
Events $A$ and $B$ are independent, events $A$ and $C$ are mutually exclusive, and events $B$ and $C$ are independent. If $\Pr[A]= \frac{1}{2}$ , $\Pr[B]= \frac{1}{4}$ , and $\Pr[C]= \frac{1}{8}$ , what is $\Pr[A \cup B \cup C]$? 
\begin{hint}
We would like to make use of two facts here:
\begin{itemize}
    \item If V and W are independent, then $\Pr(V\cap W)=\Pr(V)\cdot \Pr(W) $.
    \item $\Pr(A\cup B\cup C)=\Pr(A)+\Pr(B)+\Pr(C)-\Pr(A\cap B)-\Pr(A\cap C)-\Pr(B\cap C) +\Pr(A\cap B \cap C)$ which is the generalized Addition Principle for three events.
\end{itemize}
\end{hint}

\begin{prompt}
\begin{equation*}
\Pr(A\cup B \cup C ) = \answer{\frac{23}{32}} 
\end{equation*}

\end{prompt}
\end{problem}


\begin{problem}
A box contains four 10 bills, six 5 bills, and two 1 bills. Two bills are taken at random from the box without replacement. What is the probability that both bills will be of the same kind? 
\begin{hint}
The choices are (10,10),(5,5),(1,1) but each has a different frequency. This implies, the probabilities are different. First calculate the probabilities below and then add them as your final answer.

$\Pr(10,10)=\answer{\sage{binomial(10,2)/binomial(12,2)}}$, $\Pr(5,5)=\answer{\sage{binomial(5,2)/binomial(12,2)}}$, 
$\Pr(1,1)=\answer{\sage{binomial(2,2)/binomial(12,2)}}$.
\end{hint}

\begin{prompt}
$$ 
\Pr(\text{two of the same kind}) =\answer{\sage{(binomial(10,2)+binomial(5,2)+binomial(2,2))/(binomial(12,2))}}
$$
\end{prompt}
\end{problem}


\begin{problem}
Machine $X$ has 3 independent components, two of which fail with probability $p$ and one which fails with probability .5. The machine operates so long as at least two parts work. A second machine $Y$ has only one component which fails with probability $p$. Let $\Pr[X]$ and $\Pr[Y]$ be the probabilities that machines $X$ and $Y$ fail, respectively. What is the relationship between $\Pr[X]$ and $\Pr[Y]$? 

\begin{hint}
$\Pr[Y]=p$. We need to calculate $\Pr[X]$ as a function of $p$.
\begin{eqnarray*}
\Pr[X]&=&\Pr[\text{all 3 fail}]+\Pr[\text{first two machines fail}]+\Pr[\text{One of first two and 3rd fail}] \\
&=& \answer{\sage{p^2/2}}+\answer{\sage{p^2/2}}+\answer{\sage{2*p*(1-p)/2}} \\
&=& \answer{p}
\end{eqnarray*}
\end{hint}

\begin{prompt}
        $$\frac{\Pr[X]}{\Pr[Y]}=\answer{1} $$
\end{prompt}
\end{problem}

%%%%%%%%%%%
\begin{problem}
Urn I contains 7 red and 3 black balls, and urn II contains 4 red and 5 black balls. After a randomly selected ball is transferred from urn I to urn II, 2 balls are randomly drawn from urn II without replacement. What is the probability that both balls drawn from urn II are red? 
\begin{hint}
Let $R_1$ be the event that the ball transferred is RED and $B_1$ be the event that the ball transferred is BLACK. Let $R_2$ be the event that both balls picked from Urn II are RED. We would like to calculate $\Pr(R_2)$. We must calculate it in two mutually exclusive cases: The transferred ball is RED or BLACK decides it. 
\begin{eqnarray*} 
\Pr(R_2)
&=&\Pr(R_2\cap R_1)+\Pr(R_2\cap B_1) \\
&=&\Pr(R_2 ~|~ R_1)\Pr(R_1)+\Pr(R_2~|~ B_1)\Pr(B_1) \\
\end{eqnarray*} 
\end{hint}

\begin{prompt}
$$\Pr(R_2)=\answer{\sage{7/10*5*4/10/9+3/10*4*3/10/9}}
$$
\end{prompt}

\end{problem}

%%%%%%%%%%%
\begin{problem}
 Let $S$ and $T$ be independent events with $\Pr[S] = \Pr[T] \text{ and }\Pr[S \cup T] = \frac{1}{2}$.

What is $\Pr[S]$? 

\begin{prompt}
$$\Pr[S]=\answer{\sage{1/sqrt(2)}}.$$
\end{prompt}

\end{problem}

%%%%%%%%%%%
\begin{problem}
If 13 cards are randomly chosen without replacement from an ordinary 52-card deck, what is the probability of obtaining exactly 3 aces? 

\begin{prompt}
$$\Pr=\answer{\sage{binomial(4,3)*binomial(48,10)/binomial(52,13)}}.$$
\end{prompt}

\end{problem}

%%%%%%%%%%%
\begin{problem}
A population consists of 20 percent zeroes, 40 percent ones, and 40 percent twos. A random sample $X_1$, $X_2$ of size 2 is selected with replacement. What is $\Pr[|X_2-X_1|=1]$?
\begin{hint}
We want to calculate probabilities of all pairs $(X_1,X_2)$ such that $|X_2-X_1|=1$. Let's use the following table:

$$
\begin{array}{c|c|c|c}
  & 0 & 1 & 2 \\
0 &\answer{0.04} & \answer{0.08} & \answer{0.08} \\
\hline
1 &\answer{0.08} & \answer{0.16} & \answer{0.16} \\
\hline
2 &\answer{0.08} & \answer{0.16} & \answer{0.16} \\
\end{array}
$$
\end{hint}

\begin{prompt}
$$\Pr=\answer{\sage{0.08+0.08+0.16+0.16}}$$
\end{prompt}

\end{problem}

%%%%%%%%%%%
\begin{problem}
A family has five children. Assuming that the probability of a girl on each birth was $\frac{1}{2}$ and that the five births were independent, what is the probability the family has at least one girl, given that they have at least one boy? 
\begin{hint}
\begin{eqnarray*} X&=& \# \text{ boys } \\ 
\Pr[X \not= 5 | X \not= 0 ] &=&\frac{\Pr[X=1,2,3\text{ or }4]}{\Pr[X=1,2,3,4 \text{ or }5]} \end{eqnarray*} 

You might want to use the complement property of probability to finish this problem: $\Pr(A)=1-\Pr(A^c)$.
\end{hint}

\begin{prompt}
$$\Pr[X \not= 5 | X \not= 0 ]=\answer{\sage{(1-(1/2)^5-(1/2)^5)/(1-(1/2)^5)}}.$$
\end{prompt}

\end{problem}

%%%%%%%%%%%
\begin{problem}
Mr. Flowers plants 10 rosebushes in a row. Eight of the bushes are white and two are red, and he plants them in random order. What is the probability that he will consecutively plant seven or more white bushes? 
\begin{hint}
\end{hint}

\begin{prompt}
$$\Pr=\answer{\sage{(binomial(3,2)+binomial(3,2)*2)/binomial(10,2)}}$$
\end{prompt}

\end{problem}

%%%%%%%%%%%
\begin{problem}
 Events $S$ and $T$ have probabilities $\Pr[S] = \Pr[T] =\frac{1}{3}$ and $\Pr[S|T] =\frac{1}{6} $. What is $\Pr[S^c\cap T^c]$?
\begin{hint}
By using conditional probability, you can calculate $\Pr[S|T]=\frac{\Pr[S \cap T]}{\Pr[T]}$. Thus 
$$
\Pr[S \cap T]=\Pr[T]\Pr[S|T]=\answer{\sage{1/3*1/6}}
$$ 
We know that $S^c\cap T^c=(S\cup T)^c$. You can now use the complement rule (probability of the complement of an event) and addition rule (probability of union of two event) with the help of a Venn Diagram, to finish the problem.
\end{hint}

\begin{prompt}
$$
\Pr[S^c \cap T^c]=\Pr[(S \cup T)^c]=\answer{\sage{1-1/3-1/3+1/18}}
$$

\end{prompt}

\end{problem}

%%%%%%%%%%%
\begin{problem}
Suppose $Q$ and $S$ are independent events such that the probability that at least one of them occurs is $\frac{1}{3}$ and the probability that $Q$ occurs but $S$ does not occur is $\frac{1}{9}$. What is $\Pr[S]$?

\begin{prompt}
$$\Pr(S)=\answer{\sage{1/3-1/9}}$$
\end{prompt}

\end{problem}

%%%%%%%%%%%
\begin{problem}
A card is drawn at random from an ordinary deck of 52 cards and replaced. This is done a total of 5 independent times. What is the conditional probability of drawing the ace of spades exactly 4 times, given that this ace is drawn at least 4 times?
\begin{hint}
Calculate:
$$
\Pr(\text{ Exactly 4 })=\answer{\sage{binomial(5,4)*(1/52)^4*(51/52)^1}}
$$

$$
\Pr(\text{ Exactly 5 })=\answer{\sage{binomial(5,5)*(1/52)^5*(51/52)^0}}
$$

Now, you need to calculate the conditional probability!
\end{hint}

\begin{prompt}
$$
\Pr(\text{ Exactly 4 } | \text{ At least 4 })
=
%1-\Pr(\text{ Exactly 5 Aces } | \text{ At least 4 Aces })
%\\
%&=&
\answer{
\sage{(binomial(5,4)*(1/52)^4*(51/52)^1)/(binomial(5,4)*(1/52)^4*(51/52)^1+1/52^5)}
}
$$
\end{prompt}

\end{problem}

%%%%%%%%%%%
\begin{problem}
Suppose an experiment is conducted using a biased coin with $\Pr(H)=3/8$. What is the probability that the first Head occurs at the 10th flip.

\begin{prompt}
$$
\Pr=\answer{\sage{(5/8)^9*(3/8)}}
$$
\end{prompt}

\end{problem}

\begin{problem}
Suppose an experiment is conducted using a biased coin with $\Pr(H)=3/8$. What is the probability that the 3rd Head occurs at the 100th flip.
\begin{hint}
This problem resembles the previous problem. You basically need to decide the location of 3 Heads (one of which you already know!) and then use a similar idea to complete the problem.
\end{hint}
\begin{prompt}
$$
\Pr=\answer{\sage{binomial(99,2)*(5/8)^97*(3/8)^3}}
$$
\end{prompt}

\end{problem}

\begin{problem}
An experiment studies a cancer testing scenario:
\begin{itemize}
    \item 1\% of women have breast cancer (and therefore 99\% do not).
    \item 80\% of mammograms detect breast cancer when it is there (and therefore 20\% miss it).
    \item 9.6\% of mammograms detect breast cancer when itâ€™s not there (and therefore 90.4\% correctly return a negative result).
\end{itemize}
Calculate the probability that someone does have breast cancer given that the mammogram detected it.

\begin{hint}
We are testing the reliability of a mammogram test in this problem. Let's use $C$ for women with cancer,  $NC$ as the its complement. Similarly, lets use $M+$ for positive mammogram results (detects cancer) and $M-$ for negative results. We wish to calculate $\Pr(~C~|~M+~)$ using Bayes' Formula.
\end{hint}
$$\Pr(~C~|~M+~)
=\answer{\sage{(0.01*0.8)/(0.01*0.8+0.99*0.096)}}
$$

Please, check this answer in your calculator. You will see that a woman having breast cancer after being tested positive is less than 10\%. Could you please explain why a less than 10\% though we said someone has 80\% chance of being detected when they already have cancer?
\begin{freeResponse}

\end{freeResponse}
\end{problem}

\end{document}


\begin{problem}
Machine $X$ has 3 independent components, two of which fail with probability $p$ and one which fails with probability .5. The machine operates so long as at least two parts work. A second machine $Y$ has only one component which fails with probability $p$. Let $\Pr[X]$ and $\Pr[Y]$ be the probabilities that machines $X$ and $Y$ fail, respectively. What is the relationship between $\Pr[X]$ and $\Pr[Y]$? 

\end{problem}

\begin{problem} 
A football team ends the regular season with an 11-5 record. How many different sequences of wins and losses can lead to this outcome?

\begin{explanation}
   We are writing a 16-letter word using the alphabet $\{w,\ell\}$ by using $w$ 11 times and $\ell$ 5 times. So, the answer is 
   $$\answer{\sage{c(16,11)}}.$$
\end{explanation}
\end{problem}

\begin{problem} 
How many different terms of the form $x^ix^jx^k$ are equal to $x^{10}?$

\begin{explanation}
We count the number of non-negative integer triples $(i,j,k)$ such that $i+j+k=10$. So, the answer is 
   $$\answer{\sage{c(10+2,2)}}.$$
\end{explanation}
\end{problem}

\begin{problem}
How many permutations are there of the letters in the word
  \verb!BOOKKEEPER! in which the two \verb!O!s and the two
\verb!K!s are adjacent (but not necessarily next to each other).
\begin{hint}
Treat \verb!OO! and \verb!KK! as single letters.
\end{hint}
$$
\answer{
\sage{m(8,[1,1,1,3,1,1])
}
}
$$
\end{problem}

\begin{problem} 
At a small zoo, you are in charge of a lion, a tiger, a cheetah, and panther, and a jaguar, all in separate cages. Overnight the cages are opened by vandals, and the cats all escape. The next morning you put food in the empty cages and sure enough, the cats settle down, one per cage, for breakfast. All permutations are equally likely. What is the number of ways that one cat has returned to its original cage while two pairs have swapped cages? 

\begin{explanation}
   $$\answer{\sage{c(5,1)*c(4,2)/2}}.$$
\end{explanation}
\end{problem}

\begin{problem} 
 Star Pizza offers three choices for the diameter,
two choices for crust thickness, and 12 choices of topping.   Suppose
that you limit yourself to 5 or fewer toppings.   How many different
pizzas can you construct?
\begin{hint}
    \item[$(1)$] You first need to calculate the number of ways to select 5 or fewer toppings!
        \begin{hint}
            \item[$(1a)$] You need to use your knowledge of combinations and Addition Rule for this!
            \item[$(1b)$] You need to find the number of ways to select k=0,1,2,3,4,5 toppings out of 12 toppings first. 
        \end{hint}
    \item[$(2)$] Next, you need to use Multiplication Rule to get all possible kinds of pizzas!
        \begin{hint} $(2a)$
            How many different types of diameters, crust types and choices of at most 5 toppings do you have? You need to answer this question for each group!
        \end{hint}
\end{hint}

\begin{explanation}
    Number of all kinds of pizzas with the aforementioned possible choices is $$\answer{\sage{3*2*(binomial(12,0)+binomial(12,1)+binomial(12,2)+binomial(12,3)+binomial(12,4)+binomial(12,5))} }$$
\end{explanation}
\end{problem}



\begin{problem} 

How many distinct strings can you make out of the characters
in the word ``potato-soup''?   (Include the hyphen ``\verb!-!'' as a character.)
\begin{explanation}
$$\answer{\sage{m(11,[2,3,2,1,1,1,1])} }$$
\end{explanation}

\end{problem}



\begin{problem} 
You need to form a battle group of 11 made up of orcs, elves, and
goblins.   In how many ways can you choose the composition of your battle group?
\begin{explanation}
$$\answer{\sage{binomial(13,11)}}$$
\end{explanation}
\end{problem}



\begin{problem} 
You need to form a battle group consisting of an orc, an elf, and
a goblin whose total strength is 12.   
The strength of each creature is 
an integer between 1 and 10 and the strength of the group is the sum of the
individual strengths.  In how many ways can you construct your battle group?
\begin{hint}
    This problem would be very much like the previous one if the minimum strength were not 1. How would you adjust it?
\end{hint}
\begin{explanation}
$$\answer{\sage{binomial(11,2)} }$$
\end{explanation}

\end{problem}



\begin{problem} 
You are out in the middle of the cornfields, where the (dirt) roads
all run north-to-south or east-to-west, evenly spaced at one road per mile.   
If you start
at a road intersection and wish to get to the intersection 5 miles to the
south and 7 miles west, how many different routes could you take?
\begin{hint}
Suppose you are writing a word using the letters ``s'' and ``w''. What is the length of this word? How often they must be repeated. Can you calculate all possible words if you know the length of the word and the frequencies of letters?
\end{hint}
\begin{explanation}
$$\answer{\sage{binomial(12,5)} }$$
\end{explanation}

\end{problem}



\begin{problem} 
Your latest cheap cell phone keyboard only includes the uppercase
alphabet (26 characters total).  How many 12-character strings can you
type that start with ``ST'' and contain no more than three T's?
\begin{explanation}
$$\answer{\sage{25^10+binomial(10,1)*25^9+binomial(10,2)*25^8}}$$
\end{explanation}

\end{problem}

\end{document}

